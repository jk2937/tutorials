Hello and welcome to Jonny's Tutorials! In this tutorial, you will learn how to capture MIDI events from a DAW (Digital Audio Workstation) in real-time using the MusE DAW in Linux, the MIDI Through Port, and Python. MusE shares its coding base with the popular MuseScore software and offers advanced MIDI editing capabilities, making it an ideal choice for working with MIDI data in Linux. Although MusE comes with its own Python interface, this tutorial uses the MIDI Through Port to maintain compatibility with other software like aplaymidi.

This tutorial serves as Part Two of learning how to read the MIDI Through Port using Python in Linux. To maximize understanding, kindly complete Tutorial One prior to continuing with this guide. Throughout this second installment, we build upon foundational knowledge presented earlier, focusing on interfacing with a Digital Audio Workstation (DAW), namely MusE.

Before getting started, follow these steps to configure Jack and set up your environment:

Install packages

$  sudo apt-get install qjackctl muse qsynth

Accept realtime priority in jack

Todo: test no realtime priority

Start Jack using qjackctl:
Keep in mind that modifying the master volume control on your computer while Jack is running does not affect the playback levels. Turn up the volume before starting Jack.
Launch qjackctl and click 'Start'. If Jack fails to launch initially, try again. Sometimes jack will fail to launch the first time and suceed the second time without any change. If that doesn't work, adjust the settings under 'Setup', specifically the Interface, Sample Rate, Frames/Period, and Periods/Buffer options, until Jack runs smoothly. Finally, try rebooting your PC if you continue having issues with Jack.
Ensure that the MIDI Driver setting is set to 'seq'.
Configure audio and MIDI devices:
Set up your audio device(s) within qjackctl by selecting the desired driver, input channels, output channels, and buffer size.
Check the box next to 'Capture MIDI ports' and verify that both the ALSA sequencer client and the corresponding MIDI inputs appear in the list below.
Prepare your system for optimal performance:
Now, proceed with launching MusE and Qsynth:

Open MusE:
You may be asked to send Instrument Initialization Sequences. It doesn't matter for this tutorial, but I recommend you choose Yes here.

Initialize Qsynth:
Within Qsynth, click Setup, then Soundfonts. load a SoundFont bank by clicking the folder icon and choosing one from your collection. It should show you options from the default sf2 folder. Additional soundfonts may be aquired by downloading additional packages. (Todo: make a page on this and where each one downloads the sf2 files). 


Import the example MIDI file:
Download the daisy-bell.mid file attached to this (link) tutorial and save it locally.
Drag and drop the file onto the Part Canvas within MusE. Click Add To Project.

After completing the setup, begin playing the imported MIDI sequence and run the provided Python script to capture incoming MIDI messages:

Run the Python script:
Open a separate terminal.

Move to the midi-tutorial folder from the previous tutorial

$ cd midi-tutorial/

Todo: Change this to ~/midi-tutorial/

Execute the script by entering 


source venv/bin/activate
python3 midi_through_port_test.py


Begin playback within MusE:

Click the Play button to initiate playback



Real-time MIDI messages will now print in the console alongside timestamps.
Congratulations! By following this tutorial, you have successfully captured MIDI events from a DAW using Python and the MIDI Through Port. Feel free to explore further possibilities with MIDI and Python. 

To finish up, close qsynth, and MusE, stop jack using qjackctl, then close qjackctl.

Happy exploring!
